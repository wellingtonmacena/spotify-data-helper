<!doctype html>
<html>
<link rel="stylesheet" href="index.css">
<link href="https://fonts.googleapis.com/css2?family=Roboto+Mono&display=swap" rel="stylesheet">

<head>

  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Spotify Favorites</title>

</head>

<body>
  <div id="title">
    <span>Spotify Favorites</span>
  </div>

  <div id="sub-title">
    <span>
      Você precisa logar na sua conta do spotify antes de acessar a aplicação
    </span>

  </div>
  <div id="arrow">
    <img id="arrowImg"
      src="https://cdn.icon-icons.com/icons2/1993/PNG/512/arrow_arrows_bottom_direction_down_navigation_up_icon_123235.png"></img>
  </div>

  <div id="login">
    <a onclick="trocar()" href="/login">Logar</a>

  </div>

  <div id="sub-title1">
    <span>
      Agora volte para nossa página inicial
    </span>

  </div>

  <div id="arrow1">
    <img id="arrowImg"
      src="https://cdn.icon-icons.com/icons2/1993/PNG/512/arrow_arrows_bottom_direction_down_navigation_up_icon_123235.png"></img>
  </div>

  <div id="voltar">
    <a onclick="goBack()" >Voltar</a>

  </div>


  <script>

    function goBack() {
      const token = localStorage.getItem("access_token")
      console.log(token)
      window.location.href = `http://localhost:3000/token/${token}`
    }

    (function () {
      /**
       * Obtains parameters from the hash of the URL
       * @return Object
       */
      function getHashParams() {
        var hashParams = {};
        var e, r = /([^&;=]+)=?([^&;]*)/g,
          q = window.location.hash.substring(1);
        while (e = r.exec(q)) {
          hashParams[e[1]] = decodeURIComponent(e[2]);
        }
        return hashParams;
      }

      var params = getHashParams();

      const isNone = window.location.toString().split("/")[3]

      if(isNone.length >0){
        document.getElementById('login').style.display="none"
        document.getElementById('sub-title').style.display="none"
        document.getElementById('arrow').style.display="none"

        document.getElementById('voltar').style.display="grid"
        document.getElementById('sub-title1').style.display="grid"
        document.getElementById('arrow1').style.display="grid"


      }
      
      var access_token = params.access_token,
        refresh_token = params.refresh_token,
        error = params.error;

      //console.log(access_token)
      console.log(refresh_token)
      localStorage.setItem("access_token", access_token)
      localStorage.setItem("refresh_token", refresh_token)
    }());
  </script>
</body>

</html>